<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"><title>Anime Viewer - 动漫浏览</title><meta name="description" content="在线动漫浏览平台"><link rel="stylesheet" href="https://fonts.loli.net/icon?family=Material+Icons"><style>*{margin:0;padding:0;box-sizing:border-box}:root{--primary:#6366f1;--primary-dark:#4f46e5;--primary-light:#818cf8;--on-primary:#ffffff;--secondary:#64748b;--surface:#ffffff;--on-surface:#1e293b;--surface-variant:#f1f5f9;--on-surface-variant:#64748b;--background:#f8fafc;--error:#ef4444;--success:#10b981;--warning:#f59e0b;--shadow-sm:0 1px 2px 0 rgba(0,0,0,0.05);--shadow-md:0 4px 6px -1px rgba(0,0,0,0.1);--shadow-lg:0 10px 15px -3px rgba(0,0,0,0.1);--radius-md:0.5rem;--radius-lg:0.75rem;--transition:250ms cubic-bezier(0.4,0,0.2,1)}@media (prefers-color-scheme:dark){:root{--primary:#818cf8;--primary-dark:#6366f1;--on-primary:#0f172a;--surface:#1e293b;--on-surface:#f1f5f9;--surface-variant:#334155;--on-surface-variant:#cbd5e1;--background:#0f172a}}body{font-family:'Roboto',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--background);color:var(--on-surface);line-height:1.6;-webkit-tap-highlight-color:transparent}.app-bar{position:fixed;top:0;left:0;right:0;height:64px;background:var(--surface);box-shadow:var(--shadow-sm);display:flex;align-items:center;padding:0 1rem;z-index:1000;backdrop-filter:blur(10px)}.app-bar h1{font-size:1.25rem;font-weight:600;margin-left:0.75rem;flex:1}.icon-btn{background:none;border:none;color:var(--on-surface);cursor:pointer;padding:0.5rem;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;transition:all var(--transition);min-width:44px;min-height:44px}.icon-btn:hover{background:var(--surface-variant)}.container{margin-top:80px;padding:1rem;max-width:64rem;margin-left:auto;margin-right:auto}.search-box{background:var(--surface);border-radius:28px;display:flex;align-items:center;padding:0.75rem 1rem;box-shadow:var(--shadow-md);border:2px solid transparent;transition:all var(--transition);gap:0.75rem;margin-bottom:1rem}.search-box:focus-within{border-color:var(--primary);box-shadow:var(--shadow-lg)}.search-box input{flex:1;border:none;background:none;outline:none;font-size:1rem;padding:0.5rem 0;color:var(--on-surface);min-width:0}.search-box input::placeholder{color:var(--on-surface-variant)}.btn{background:var(--primary);color:var(--on-primary);border:none;border-radius:var(--radius-lg);padding:0.625rem 1.5rem;font-size:0.875rem;font-weight:500;cursor:pointer;transition:all var(--transition);display:inline-flex;align-items:center;gap:0.5rem;min-height:44px;white-space:nowrap}.btn:hover{background:var(--primary-dark);box-shadow:var(--shadow-md)}.btn:disabled{opacity:0.5;cursor:not-allowed}.history{background:var(--surface);border-radius:var(--radius-lg);padding:1rem;box-shadow:var(--shadow-sm);margin-bottom:1rem}.history h3{font-size:0.875rem;color:var(--on-surface-variant);margin-bottom:0.75rem;display:flex;align-items:center;justify-content:space-between}.chips{display:flex;flex-wrap:wrap;gap:0.5rem}.chip{background:var(--surface-variant);color:var(--on-surface);border:none;border-radius:16px;padding:0.375rem 0.75rem;font-size:0.875rem;cursor:pointer;transition:all var(--transition);display:flex;align-items:center;gap:0.25rem}.chip:hover{background:var(--primary-light);color:var(--on-primary)}.chip.active{background:var(--primary);color:var(--on-primary)}.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem}.card{background:var(--surface);border-radius:var(--radius-lg);padding:1.25rem;box-shadow:var(--shadow-md);transition:all var(--transition);cursor:pointer}.card:hover{box-shadow:var(--shadow-lg);transform:translateY(-4px)}.card-title{font-size:1.125rem;font-weight:600;margin-bottom:0.75rem;line-height:1.4}.card-meta{font-size:0.875rem;color:var(--on-surface-variant);display:flex;gap:0.5rem;flex-wrap:wrap;align-items:center}.card-meta span{background:var(--surface-variant);padding:0.25rem 0.5rem;border-radius:var(--radius-md);font-size:0.75rem}.list-item{background:var(--surface);border-radius:var(--radius-lg);margin-bottom:0.75rem;padding:1rem;display:flex;align-items:center;cursor:pointer;transition:all var(--transition);box-shadow:var(--shadow-sm);gap:1rem}.list-item:hover{background:var(--surface-variant);transform:translateX(4px)}.list-item .material-icons{color:var(--primary);font-size:1.5rem;flex-shrink:0}.list-item-text{flex:1;min-width:0}.list-item-title{font-size:1rem;font-weight:500;margin-bottom:0.25rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.list-item-subtitle{font-size:0.875rem;color:var(--on-surface-variant)}.loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem;color:var(--on-surface-variant)}.spinner{width:3rem;height:3rem;border:3px solid var(--surface-variant);border-top-color:var(--primary);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}@keyframes spin{to{transform:rotate(360deg)}}.empty{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 1rem;color:var(--on-surface-variant);text-align:center}.empty .material-icons{font-size:4rem;margin-bottom:1rem;opacity:0.3}.snackbar{position:fixed;bottom:1.5rem;left:50%;transform:translateX(-50%) translateY(100px);background:var(--surface);color:var(--on-surface);padding:0.875rem 1.25rem;border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);transition:transform var(--transition);z-index:2000;max-width:calc(100% - 2rem)}.snackbar.show{transform:translateX(-50%) translateY(0)}.snackbar.error{background:var(--error);color:white}.snackbar.success{background:var(--success);color:white}.snackbar.warning{background:var(--warning);color:white}.hidden{display:none !important}.fab{position:fixed;bottom:1.5rem;right:1.5rem;width:3.5rem;height:3.5rem;border-radius:var(--radius-lg);background:var(--primary);color:var(--on-primary);border:none;box-shadow:var(--shadow-lg);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all var(--transition);z-index:999}.fab:hover{background:var(--primary-dark);transform:scale(1.1)}.fab.hidden{opacity:0;transform:scale(0);pointer-events:none}.player-page{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:calc(100vh - 80px)}.player-card{background:var(--surface);border-radius:var(--radius-lg);padding:2rem;box-shadow:var(--shadow-lg);max-width:500px;width:100%;text-align:center}.player-card .material-icons{font-size:4rem;color:var(--primary);margin-bottom:1rem}.player-card h2{font-size:1.5rem;margin-bottom:0.5rem;word-break:break-all}.player-card p{color:var(--on-surface-variant);margin-bottom:2rem;font-size:0.95rem}.player-card a{display:inline-block;background:var(--primary);color:var(--on-primary);padding:0.75rem 2rem;border-radius:var(--radius-lg);text-decoration:none;transition:all var(--transition);font-weight:500;cursor:pointer}.player-card a:hover{background:var(--primary-dark);box-shadow:var(--shadow-md);transform:scale(1.05)}@media (max-width:768px){.container{margin-top:72px;padding:0.75rem}.grid{grid-template-columns:1fr;gap:0.75rem}.player-card{padding:1.5rem;margin:1rem}}</style></head><body><div id="skeleton" style="position: fixed; inset: 0; background: var(--background); z-index: 2000;"><div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;"><div class="spinner"></div><p style="margin-top: 1rem; color: var(--on-surface-variant);">加载中...</p></div></div><header class="app-bar"><button class="icon-btn" onclick="goHome()"><span class="material-icons">home</span></button><h1 id="appTitle">Anime Viewer</h1></header><main id="app"><div id="searchPage"><div class="container"><div class="search-box"><span class="material-icons" style="color: var(--on-surface-variant);">search</span><input type="search" id="searchInput" placeholder="搜索动漫..." onkeypress="e.key === 'Enter' &amp;&amp; searchAnime()" autocomplete="off"><button class="btn" onclick="searchAnime()" id="searchBtn">搜索</button></div><div id="searchHistory" class="history hidden"><h3>搜索历史<button class="icon-btn" onclick="clearHistory()" style="min-width: auto; min-height: auto; padding: 0.25rem;"><span class="material-icons" style="font-size: 1rem;">delete</span></button></h3><div id="historyChips" class="chips"></div></div></div><div id="searchResults" class="container"><div class="empty"><span class="material-icons">search</span><p>输入关键词搜索动漫</p></div></div></div><div id="episodesPage" class="hidden"><div class="container" style="margin-top: 80px;"><div id="channelChips" class="chips" style="margin-bottom: 1rem;"></div><div id="episodesList"></div></div></div><div id="playerPage" class="hidden"><div class="container player-page"><div class="player-card"><span class="material-icons">play_circle_filled</span><h2 id="playerTitle">准备就绪</h2><p id="playerSubtitle">点击下方按钮前往播放器观看</p><a id="playerLink" href="#" target="_blank">立即前往播放器</a></div></div></div></main><button class="fab hidden" onclick="scrollToTop()" id="backToTop"><span class="material-icons">arrow_upward</span></button><div id="snackbar" class="snackbar"></div><script>const API_BASE="https://anigirl.dahi.edu.eu.org",state={searchResults:[],channels:[],currentAnime:null,currentChannel:0,history:[]};function handleRoute(){const e=window.location.hash.slice(1);if(!e)return void showSearchPage();const[t,...n]=e.split("/"),s=n.join("/");hideAll(),"episodes"===t&&s?showEpisodesPage(decodeURIComponent(s)):"confirm"===t&&s?showPlayerConfirmPage(decodeURIComponent(s)):showSearchPage(),window.scrollTo({top:0,behavior:"smooth"})}function hideAll(){document.getElementById("searchPage").classList.add("hidden"),document.getElementById("episodesPage").classList.add("hidden"),document.getElementById("playerPage").classList.add("hidden")}function showSearchPage(){document.getElementById("searchPage").classList.remove("hidden"),document.getElementById("appTitle").textContent="Anime Viewer",document.getElementById("backToTop").classList.add("hidden"),setTimeout((()=>document.getElementById("searchInput")?.focus()),100)}function goHome(){window.location.hash=""}function addToHistory(e){state.history=[e,...state.history.filter((t=>t!==e))].slice(0,10),sessionStorage.setItem("history",JSON.stringify(state.history)),renderHistory()}function renderHistory(){const e=document.getElementById("searchHistory"),t=document.getElementById("historyChips");0!==state.history.length?(e.classList.remove("hidden"),t.innerHTML=state.history.map((e=>`<button class="chip" onclick="searchFromHistory('${esc(e)}')">\n<span class="material-icons" style="font-size: 1rem;">history</span>\n${esc(e)}\n</button>`)).join("")):e.classList.add("hidden")}function searchFromHistory(e){document.getElementById("searchInput").value=e,searchAnime()}function clearHistory(){confirm("确定清除搜索历史?")&&(state.history=[],sessionStorage.removeItem("history"),renderHistory(),toast("已清除搜索历史","success"))}async function searchAnime(){const e=document.getElementById("searchInput").value.trim();if(!e)return void toast("请输入搜索关键词","warning");const t=document.getElementById("searchResults"),n=document.getElementById("searchBtn");t.innerHTML='<div class="loading"><div class="spinner"></div><p>搜索中...</p></div>',n.disabled=!0,n.textContent="搜索中...";try{const n=await fetch(`${API_BASE}/api/search?keyword=${encodeURIComponent(e)}`),s=await n.json();s.success&&s.results?.length>0?(addToHistory(e),state.searchResults=s.results,renderResults(s.results),toast(`找到 ${s.results.length} 个结果`,"success")):(t.innerHTML='\n<div class="empty">\n<span class="material-icons">search_off</span>\n<p>没有找到相关动漫</p>\n</div>',toast("没有找到相关动漫","warning"))}catch(e){console.error("搜索失败:",e),t.innerHTML='\n<div class="empty">\n<span class="material-icons">error_outline</span>\n<p>搜索失败</p>\n<button class="btn" style="margin-top: 1rem;" onclick="searchAnime()">重试</button>\n</div>',toast("搜索失败","error")}finally{n.disabled=!1,n.textContent="搜索"}}function renderResults(e){document.getElementById("searchResults").innerHTML=`<div class="grid">${e.map((e=>`\n<div class="card" onclick="goToEpisodes('${esc(e.url)}')">\n<div class="card-title">${esc(e.title)}</div>\n<div class="card-meta">\n<span class="material-icons" style="background: none; padding: 0;">movie</span>\n${e.status?`<span>${esc(e.status)}</span>`:""}\n${e.year?`<span>${esc(e.year)}</span>`:""}\n</div>\n</div>\n`)).join("")}</div>`}function goToEpisodes(e){window.location.hash=`episodes/${encodeURIComponent(e)}`}async function showEpisodesPage(e){document.getElementById("episodesPage").classList.remove("hidden"),document.getElementById("appTitle").textContent="加载中...",document.getElementById("backToTop").classList.remove("hidden");const t=document.getElementById("channelChips"),n=document.getElementById("episodesList");t.innerHTML="",n.innerHTML='<div class="loading"><div class="spinner"></div><p>加载剧集中...</p></div>';try{const s=await fetch(`${API_BASE}/api/episodes?url=${encodeURIComponent(e)}`),o=await s.json();o.success&&o.channels?.length>0?(state.channels=o.channels,state.currentAnime={url:e,title:o.title},o.channels.length>1&&(t.innerHTML=o.channels.map(((e,t)=>`<button class="chip ${0===t?"active":""}" onclick="switchChannel(${t})">\n${esc(e.channel)} (${e.count})\n</button>`)).join("")),renderEpisodes(0),document.getElementById("appTitle").textContent=o.title||"选择剧集",toast(`共 ${o.totalEpisodes} 集`,"success")):(n.innerHTML='\n<div class="empty">\n<span class="material-icons">tv_off</span>\n<p>没有找到剧集</p>\n<button class="btn" style="margin-top: 1rem;" onclick="history.back()">返回</button>\n</div>',toast("没有找到剧集","warning"))}catch(e){console.error("加载剧集失败:",e),n.innerHTML='\n<div class="empty">\n<span class="material-icons">error_outline</span>\n<p>加载失败</p>\n<button class="btn" style="margin-top: 1rem;" onclick="history.back()">返回</button>\n</div>',toast("加载失败","error")}}function switchChannel(e){state.currentChannel=e,document.querySelectorAll("#channelChips .chip").forEach(((t,n)=>{t.classList.toggle("active",n===e)})),renderEpisodes(e)}function renderEpisodes(e){const t=state.channels[e],n=document.getElementById("episodesList");n.innerHTML=t?.episodes?t.episodes.map((e=>`\n<div class="list-item" onclick="playEpisode('${esc(e.url)}', '${esc(e.name)}')">\n<span class="material-icons">play_circle_filled</span>\n<div class="list-item-text">\n<div class="list-item-title">${esc(e.name)}</div>\n<div class="list-item-subtitle">第 ${esc(e.sort)} 集</div>\n</div>\n<span class="material-icons">chevron_right</span>\n</div>\n`)).join(""):'\n<div class="empty">\n<span class="material-icons">tv_off</span>\n<p>该频道暂无剧集</p>\n</div>'}async function playEpisode(e,t){toast("获取播放地址中...","success");try{const n=await fetch(`${API_BASE}/api/video?url=${encodeURIComponent(e)}`),s=await n.json();if(s.success&&s.videoUrl){let e=s.videoUrl.replace(/ai\.girigirilove\.net/g,"animegirlair.dahi.edu.eu.org");window.location.hash=`confirm/${encodeURIComponent(e)}/${encodeURIComponent(t)}`}else toast(s.error||"无法获取视频地址","error")}catch(e){console.error("获取视频失败:",e),toast("获取视频失败","error")}}function showPlayerConfirmPage(e,t){document.getElementById("playerPage").classList.remove("hidden"),document.getElementById("appTitle").textContent="播放确认",document.getElementById("backToTop").classList.remove("hidden");const n=e.split("/"),s=n[n.length-1]||"视频";document.getElementById("playerTitle").textContent=s,document.getElementById("playerSubtitle").textContent="已获取播放地址，点击下方按钮前往播放器";const o=`./player.html#url=${e}`;document.getElementById("playerLink").href=o}function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function toast(e,t=""){const n=document.getElementById("snackbar");n.textContent=e,n.className=`snackbar ${t} show`,setTimeout((()=>n.classList.remove("show")),3e3)}function esc(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}window.addEventListener("load",(()=>{setTimeout((()=>document.getElementById("skeleton").style.display="none"),500);try{state.history=JSON.parse(sessionStorage.getItem("history")||"[]")}catch(e){state.history=[]}handleRoute(),window.addEventListener("hashchange",handleRoute),window.addEventListener("scroll",(()=>{document.getElementById("backToTop").classList.toggle("hidden",window.scrollY<=300)})),renderHistory()}));</script></body></html>